{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <script>
        var count = 0;

    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <title>Document</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load("current", { packages: ["corechart"] });
        google.charts.setOnLoadCallback(drawChart);
        function drawChart() {
            var count = parseInt('{{ count }}');
            console.log(count);
            
            var player = parseInt('{{ player }}');
            console.log(player);
            
            var playerPercentage = (player / count) * 100;
            var totalPercentage = 100 - playerPercentage;
    
            var data = google.visualization.arrayToDataTable([
                ['Task', 'Percentage'],
                ['', playerPercentage],
                ['', totalPercentage],
            ]);
    
            var options = {
                is3D: true,
                legend: 'none',
          pieSliceText: 'none',
            };
    
            var chart = new google.visualization.PieChart(document.getElementById('piechart_player_3d'));
            chart.draw(data, options);
        }
    </script>
    <script type="text/javascript">
        google.charts.load("current", { packages: ["corechart"] });
        google.charts.setOnLoadCallback(drawChart);
        function drawChart() {
            var count = parseInt('{{ count }}');
            console.log(count);
            
            var player = parseInt('{{ club }}');
            console.log(player);
            
            var playerPercentage = (player / count) * 100;
            var totalPercentage = 100 - playerPercentage;
    
            var data = google.visualization.arrayToDataTable([
                ['Task', 'Percentage'],
                ['', playerPercentage],
                ['', totalPercentage],
            ]);
    
            var options = {
                is3D: true,
                legend: 'none',
          pieSliceText: 'none',
            };
    
            var chart = new google.visualization.PieChart(document.getElementById('piechart_club_3d'));
            chart.draw(data, options);
        }
    </script>
    
</head>

<body class="bg-light">
    {% if user.is_superuser %}
    <nav class="navbar player-navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="ms-5 navbar-brand d-flex fs-2 fw-bold" href="#">
                <p class="text-white">Urban</p>
                <p class="text-warning">Scout</p>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="ms-3 d-flex w-50">
                    <input type="text" class="form-control" placeholder="Search">
                    <button class="btn shadow-none"><i class="bi bi-search fs-3 text-white"></i></button>
                </div>
                <div class="ms-3">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link  text-white" aria-current="page" href="{% url 'index' %}">Manage
                                Users</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-secondary" aria-current="page" href="{% url 'RegisterScout' %}">Register Scouts</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-secondary" aria-current="page"
                                href="{% url 'email' %}">Clubs</a>
                        </li>

                    </ul>
                </div>
                <div class="d-flex w-100 justify-content-start justify-content-sm-end">
                    <div class="border rounded p-2 pb-0 mt-2 ms-3">
                        <p class="text-light "><i class="bi bi-person-circle"></i> Admin</p>
                    </div>
                    <div class="d-flex justify-content-center flex-column">
                        <a class="d-flex flex-column justify-content-center text-decoration-none" href="{% url 'logout' %}"><button class="btn text-white ms-4">Log-out</button></a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <div class="d-flex justify-content-center">
        <div class="bg-white shadow-lg mt-4 pb-3 rounded col-12 col-lg-8">
            <p class="m-4 text-secondary fs-4 fw-bold">Manage Users</p>

            <div class="d-flex justify-content-center flex-lg-row align-items-center text-center flex-column">
                <div class="d-flex col-3 justify-content-center flex-column align-items-center">
                    <p class="fs-5 text-secondary">Number of Users</p>
                    <p class="fs-4">{{count}}</p>
                </div>
                <div class="d-flex col-3 justify-content-center flex-column align-items-center">
                    <p class="fs-5 text-secondary">Number of Players</p>
                    <p class="fs-4">{{player}}</p>
                    <div id="piechart_player_3d" style="width: 240px; height: 240px;"></div>
                </div>
                <div class="d-flex col-3 justify-content-center flex-column align-items-center">
                    <p class="fs-5 text-secondary">Number of Clubs</p>
                    <p class="fs-4">{{club}}</p>
                    <div id="piechart_club_3d" style="width: 240px; height: 240px;"></div>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table rounded text-center table-hover table-bordered">
                    <tr class="thead fw-bold">

                        <td>Email</td>
                        <td>User Role</td>
                        <td>Status</td>
                        <td>Edit Status</td>
                        <td>Delete User</td>

                    </tr>
                    {% for i in users %}
                    {% if not i.is_staff %}
                    <tr>

                        <td>{{i.email}}</td>
                        <td>{% if i.is_player %}
                            Player
                            {% elif i.is_club %}
                            Club
                            {% else %}
                            Scout
                            {% endif %}</td>
                        <td>{{i.is_active}}</td>
                        <td><a href="{% url 'updateStatus' i.id %}"><button class="btn btn-primary"><i
                                        class="bi bi-pencil-square"></i></button></a></td>
                        <td><a href="{% url 'deleteUser' i.id %}"><button class="btn btn-danger"><i
                                        class="bi bi-trash3-fill"></i></button></a></td>

                    </tr>
                    {% endif %}
                    {% endfor %}
                </table>
            </div>

        </div>
    </div>
    {% elif user.is_club %}
    <nav class="navbar player-navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="ms-5 navbar-brand d-flex fs-2 fw-bold" href="#">
                <p class="text-white">Urban</p>
                <p class="text-warning">Scout</p>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="ms-3 d-flex w-50">
                    <input type="text" class="form-control" placeholder="Search">
                    <button class="btn shadow-none"><i class="bi bi-search fs-3 text-white"></i></button>
                </div>
                <div class="ms-3">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link  text-white" aria-current="page" href="#">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-secondary" aria-current="page" href="#">Scouts</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-secondary" aria-current="page" href="{% url 'ClubPlayer' %}">Players</a>
                        </li>
                    </ul>
                </div>
                <div class="d-flex w-100 justify-content-start justify-content-sm-end">
                    <div class="border rounded p-2 pb-0 mt-2 ms-3">
                        <p class="text-light "><i class="bi bi-shield-fill"></i> {{user.club_name}}</p>
                    </div>
                    <a class="d-flex flex-column justify-content-center text-decoration-none" href="{% url 'logout' %}"><button class="btn text-white ms-4">Log-out</button></a>
                </div>
            </div>
        </div>
    </nav>
    <div class="d-flex flex-wrap justify-content-center mt-4">
        <div class="col-lg-3 h-50 col-12 m-3 p-5 rounded bg-white shadow-lg position-sticky">
            <div class="">
                <div class="d-flex justify-content-center">
                    <div class="">
                        <img class="rounded-circle img-width " src={{user.img.url}} alt="">
                    </div>
                </div>
                <div class="text-center">
                    <p class="text-dark mt-2 fs-4 fw-bold">{{user.club_name}}</p>
                    <p class="text-secondary">District: {{user.district}}</p>
                    <p class="text-secondary">Locality: {{user.locality}}</p>
                    
                </div>
                <div>
                    <p>Club Reputation: <i class="bi bi-star-fill text-warning"></i><i
                            class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i
                            class="bi bi-star-fill text-warning"></i><i class="bi bi-star-half text-warning"></i></p>
                </div>
                <div class="d-flex justify-content-center"><a href="{% url 'EditClub' %}"><button class="btn btn-outline-primary">Edit Profile</button></a></div>
            </div>
        </div>
        <div class="col-lg-5 col-12 player-feeds m-3 p-5 rounded bg-white shadow-lg">
            <div class="w-100 d-flex justify-content-center">
                <div class="w-100">
                    <textarea class="form-control" name="" id="" cols="30" rows="5"
                        placeholder="Share a post"></textarea>
                    <div class="d-flex justify-content-around m-2 mt-4">
                        <button class="btn btn-outline-primary"><i class="bi bi-image"></i> Photo</button>
                        <button class="btn btn-outline-success"><i class="bi bi-play-btn-fill"></i> Video</button>
                        <button class="btn btn-outline-warning"><i class="bi bi-send-fill"></i> Post</button>
                    </div>
                </div>
            </div>
            <div class="mt-4 border-top pt-4">
                <div class="d-flex">
                    <div class="feed-img">
                        <img class="w-100 rounded-circle" src={{user.img.url}} alt="">
                    </div>
                    <div class="ms-2">
                        <p class="fw-bold">
                            {{user.club_name}}
                        </p>

                    </div>
                </div>
                <div class="w-100 mt-3">
                    <img class="w-100"
                        src="https://images.unsplash.com/photo-1589487391730-58f20eb2c308?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxleHBsb3JlLWZlZWR8Nnx8fGVufDB8fHx8fA%3D%3D&w=1000&q=80"
                        alt="">
                </div>
                <div class="mt-3">
                    <p class="fw-bold">{{user.club_name}}
                    <p>Retail giants like Reliance Retail, Aditya Birla Fashion & Retail, and Devyani International,
                        among others, are on an offline expansion spree, but real estate is proving hard to come by,
                        reports Livemint.</p>
                    </p>

                </div>
            </div>


        </div>
        <div class="col-lg-3 col-12">
            <div class="m-3 p-5 rounded bg-white shadow-lg">
                <div>
                    <p class="fw-bold">Recommended Players</p>
                    <div class="d-flex">
                        <div class="rec-img-club">
                            <img class="w-100 rounded-circle"
                                src="https://www.shareicon.net/data/2016/07/05/791224_man_512x512.png" alt="">
                        </div>
                        <p class="ms-2">Mohammed Salah</p>
                    </div>


                </div>
            </div>
            <div class="m-3 p-5 rounded bg-white shadow-lg">
                <div>
                    <p class="fw-bold">Recommended Scouts</p>
                    <div class="d-flex">
                        <div class="rec-img-club">
                            <img class="w-100 rounded-circle"
                                src="https://www.shareicon.net/data/2016/07/05/791224_man_512x512.png" alt="">
                        </div>
                        <p class="ms-2">Athletico Club</p>
                    </div>

                </div>
            </div>
        </div>
    </div>
    {% elif user.is_player %}
    <nav class="navbar player-navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="ms-5 navbar-brand d-flex fs-2 fw-bold" href="#">
                <p class="text-white">Urban</p>
                <p class="text-warning">Scout</p>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="ms-3 d-flex w-50">
                    <input type="text" class="form-control" placeholder="Search">
                    <button class="btn shadow-none"><i class="bi bi-search fs-3 text-white"></i></button>
                </div>
                <div class="ms-3">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link  text-white" aria-current="page" href="#">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-secondary" aria-current="page" href="#">Scouts</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-secondary" aria-current="page"
                                href="{% url 'player-club' %}">Clubs</a>
                        </li>

                    </ul>
                </div>
                <div class="d-flex w-100 justify-content-start justify-content-sm-end">
                    <div class="border rounded p-2 pb-0 mt-2 ms-3">
                        <p class="text-light "><i class="bi bi-person-circle"></i> {{user.first_name}}</p>
                    </div>
                    <a class="d-flex flex-column justify-content-center text-decoration-none" href="{% url 'logout' %}"><button class="btn text-white ms-4">Log-out</button></a>
                </div>
            </div>
        </div>
    </nav>
    <div class="d-flex flex-wrap justify-content-center mt-4">
        <div class="col-lg-3 h-50 col-12 m-3 p-5 rounded bg-white shadow-lg position-sticky">
            <div class="">
                <div class="d-flex justify-content-center">
                    <div class="">
                        <img class="rounded-circle img-width" src={{user.img.url}} alt="">
                    </div>
                </div>
                <div class="text-center">
                    <p class="text-dark mt-2 fs-4 fw-bold">{{user.first_name}} {{user.last_name}}</p>
                    <p id="age" class="text-secondary"></p>
                    <script>
                        var playerDobString = "{{ user.player_dob }}";
                        console.log(playerDobString);
                    
                        var dobParts;
                        var year, month, day;
                    
                        if (playerDobString.includes('.')) {
                            // Format: Oct. 17, 2001
                            var months = {
                                'Jan.': 0, 'Feb.': 1, 'March': 2, 'Apr.': 3, 'May': 4, 'June': 5,
                                'Jul.': 6, 'Aug.': 7, 'Sept.': 8, 'Oct.': 9, 'Nov.': 10, 'Dec.': 11
                            };
                    
                            dobParts = playerDobString.split(' ');
                            month = months[dobParts[0]];
                            day = parseInt(dobParts[1].replace(',', ''));
                            year = parseInt(dobParts[2]);
                        } else {
                            // Format: 2001-10-17
                            dobParts = playerDobString.split('-');
                            year = parseInt(dobParts[0]);
                            month = parseInt(dobParts[1]) - 1; // Months are 0-indexed in JavaScript
                            day = parseInt(dobParts[2]);
                        }
                    
                        // Create a Date object from the parsed parts
                        var playerDate = new Date(year, month, day);
                    
                        // Calculate the age based on player's date of birth
                        var today = new Date();
                        var age = today.getFullYear() - playerDate.getFullYear() - (today.getMonth() < playerDate.getMonth() || (today.getMonth() === playerDate.getMonth() && today.getDate() < playerDate.getDate()) ? 1 : 0);
                    
                        // You can now use the 'age' variable for your JavaScript logic
                        console.log("Player's age is: " + age);
                        document.getElementById("age").textContent = "Age: " + age;
                    </script>
                    

                    <p class="text-secondary">Position: {{user.player_pos}}</p>
                    <p class="text-secondary">District: {{user.district}}</p>
                    <p class="text-secondary">Locality: {{user.locality}}</p>
                </div>
                <div>
                    <p>Ability: <i class="bi bi-star-fill text-warning"></i><i
                            class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i
                            class="bi bi-star-fill text-warning"></i><i class="bi bi-star-half text-warning"></i></p>
                    <p>Potential: <i class="bi bi-star-fill text-warning"></i><i
                            class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i
                            class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i></p>
                </div>
                <div class="d-flex justify-content-center"><a href="{% url 'edit-player-profile' %}"><button
                            class="btn btn-outline-info">Edit Profile</button></a></div>
            </div>
        </div>
        <div class="col-lg-5 col-12 player-feeds m-3 p-5 rounded bg-white shadow-lg">
            <div class="w-100 d-flex justify-content-center">
                <div class="w-100">
                    <textarea class="form-control" name="" id="" cols="30" rows="5"
                        placeholder="Share a post"></textarea>
                    <div class="d-flex justify-content-around m-2 mt-4">
                        <button class="btn btn-outline-primary"><i class="bi bi-image"></i> Photo</button>
                        <button class="btn btn-outline-success"><i class="bi bi-play-btn-fill"></i> Video</button>
                        <button class="btn btn-outline-warning"><i class="bi bi-send-fill"></i> Post</button>
                    </div>
                </div>
            </div>
            <div class="mt-4 border-top pt-4">
                <div class="d-flex">
                    <div class="feed-img">
                        <img class="w-100 rounded-circle" src={{user.img.url}} alt="">
                    </div>
                    <div class="ms-2">
                        <p class="fw-bold">
                            {{user.first_name}} {{user.last_name}}
                        </p>

                    </div>
                </div>
                <div class="w-100 mt-3">
                    <img class="w-100"
                        src="https://images.unsplash.com/photo-1589487391730-58f20eb2c308?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxleHBsb3JlLWZlZWR8Nnx8fGVufDB8fHx8fA%3D%3D&w=1000&q=80"
                        alt="">
                </div>
                <div class="mt-3">
                    <p class="fw-bold">{{user.first_name}} {{user.last_name}}
                    <p>Retail giants like Reliance Retail, Aditya Birla Fashion & Retail, and Devyani International,
                        among others, are on an offline expansion spree, but real estate is proving hard to come by,
                        reports Livemint.</p>
                    </p>

                </div>
            </div>


        </div>
        <div class="col-lg-3 col-12">
            <div class="m-3 p-5 rounded bg-white shadow-lg">
                <div>
                    <p class="fw-bold">Recommended Clubs</p>
                    {% for clubs in clubdata %}

                    <div class="d-flex">
                        <div class="rec-img-club">
                            <img class="w-100 rounded-circle"
                                src="{{clubs.img}}" alt="">
                        </div>
                        <p class="ms-2">{{clubs.club_name}}</p>
                    </div>
                    {% endfor %}


                </div>
            </div>
            <div class="m-3 p-5 rounded bg-white shadow-lg">
                <div>
                    <p class="fw-bold">Recommended Scouts</p>
                    {% for scouts in scout %}
                    <div class="d-flex">
                        <div class="rec-img-club">
                            <img class="w-100 rounded-circle"
                                src="{{scouts.img}}" alt="">
                        </div>
                        <p class="ms-2">{{scouts.first_name}} {{scouts.last_name}}</p>
                    </div>
                    {% endfor %}

                </div>
            </div>
        </div>
    </div>
    {% elif user.is_authenticated %}
    <div class="d-flex justify-content-center vh-100 align-items-center">
        <div class="col-lg-5 col-12 text-center">
            <h1>Select user type</h1>
            <div class="d-flex d-flex justify-content-evenly mt-5">
                <a href="{% url 'player-selected' %}">
                    <button class="p-5 btn btn-outline-primary">
                        <i class="bi bi-person-fill fs-1"></i>
                        <p>Player</p>
                    </button>
                </a>
                <a href="{% url 'club-selected' %}">
                    <button class="p-5 btn btn-outline-primary">
                        <i class="bi bi-shield-fill fs-1"></i>
                        <p>Club</p>
                    </button>
                </a>
            </div>
        </div>
    </div>
    {% else %}
    <div class="hero">
        <div class="overlay text-center p-5 d-flex flex-column justify-content-center">
            <p class="h1 text-white fw-bold">UrbanScout</p>
            <p class="h5 text-secondary mt-3">"Unleash Urban Football Excellence with UrbanScout! Discover the Rising
                Stars of the City Streets. Join our Dynamic Football Community, where Players, Scouts, and Clubs Unite
                to Ignite the Passion for the Game. Embrace Talent, Empower Dreams, and Redefine Football Scouting in
                Urban Landscapes. Step into the World of UrbanScout â€“ Where Talent Meets Opportunity!"</p>
            <div class="d-flex justify-content-center">
                <a href="{% url 'login' %}">
                    <button class="button mt-5">
                        <span class="button-content">Log-in</span>
                    </button>
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</body>

</html>